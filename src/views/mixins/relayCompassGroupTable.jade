mixin relayCompassGroupTable(relays, notDisplayed, uiFlags)
    table.relay-summary-list.datatable
        thead
            tr
                th
                    a(href='search-compass?#{format.searchQuery(requestQuery, "country")}', title='sort by country')
                        | Country
                        if requestQuery.sortBy === 'country'
                            if uiFlags.hasCountryFlags
                                != format.sortIndicator('alpha', normRequestQuery.sortAsc)
                            else
                                != format.sortIndicator('numeric', normRequestQuery.sortAsc)
                th.align-left
                    a(href='search-compass?#{format.searchQuery(requestQuery, "fingerprint")}', title='sort by fingerprints')
                        | Fingerprints
                        if requestQuery.sortBy === 'fingerprint'
                            != format.sortIndicator('numeric', normRequestQuery.sortAsc)
                th.align-left
                    a(href='search-compass?#{format.searchQuery(requestQuery, "as_number")}', title='sort by autonomous system')
                        | Autonomous System
                        if requestQuery.sortBy === 'as_number'
                            != format.sortIndicator('alpha', normRequestQuery.sortAsc)
                th
                    a(href='search-compass?#{format.searchQuery(requestQuery, "consensus_weight_fraction")}', title='consensus weights')
                        | Consensus Weights
                        if requestQuery.sortBy === 'consensus_weight_fraction'
                            != format.sortIndicator('numeric', normRequestQuery.sortAsc)
                th
                    a(href='search-compass?#{format.searchQuery(requestQuery, "advertised_bandwidth_fraction")}', title='sort by advertised bandwidth')
                        | Advertised Bandwidth
                        if requestQuery.sortBy === 'advertised_bandwidth_fraction'
                            != format.sortIndicator('numeric', normRequestQuery.sortAsc)
                th
                    a(href='search-compass?#{format.searchQuery(requestQuery, "guard_probability")}', title='sort by guard probability')
                        | Guard Prob.
                        if requestQuery.sortBy === 'guard_probability'
                            != format.sortIndicator('numeric', normRequestQuery.sortAsc)
                th
                    a(href='search-compass?#{format.searchQuery(requestQuery, "middle_probability")}', title='sort by middle probability')
                        | Middle Prob.
                        if requestQuery.sortBy === 'middle_probability'
                            != format.sortIndicator('numeric', normRequestQuery.sortAsc)
                th
                    a(href='search-compass?#{format.searchQuery(requestQuery, "exit_probability")}', title='sort by exit probability')
                        | Exit Prob.
                        if requestQuery.sortBy === 'exit_probability'
                            != format.sortIndicator('numeric', normRequestQuery.sortAsc)
        if relays.length
            tbody
                each relay in relays
                    tr
                        td.align-center
                            a(href='/relay/'+relay.fingerprint)
                                if uiFlags.hasCountryFlags
                                    != format.flaggify(Object.keys(relay.country)[0])
                                else
                                    = Object.keys(relay.country).length
                        td
                            a(href='/relay/'+relay.fingerprint) #{relay.fingerprints.length}
                        td
                            a(href='/relay/'+relay.fingerprint)
                                if uiFlags.hasOneASNumber
                                    | #{Object.keys(relay.as_number)[0]} #{Object.keys(relay.as_name)[0]}
                                else
                                    | #{Object.keys(relay.as_number).length}
                        td.align-center
                            a(href='/relay/'+relay.fingerprint) #{format.percent(relay.consensus_weight_fraction, 4)}
                        td.align-center
                            a(href='/relay/'+relay.fingerprint) #{format.percent(relay.advertised_bandwidth_fraction, 4)}
                        td.align-center
                            a(href='/relay/'+relay.fingerprint) #{format.percent(relay.guard_probability, 4)}
                        td.align-center
                            a(href='/relay/'+relay.fingerprint) #{format.percent(relay.middle_probability, 4)}
                        td.align-center
                            a(href='/relay/'+relay.fingerprint) #{format.percent(relay.exit_probability, 4)}
            tfoot
                tr
                    td
                    td
                    td
                        p #{notDisplayed.number} other relay groups
                    td.align-center
                        p #{format.percent(notDisplayed.consensus_weight_fraction, 4)}
                    td.align-center
                        p #{format.percent(notDisplayed.advertised_bandwidth_fraction, 4)}
                    td.align-center
                        p #{format.percent(notDisplayed.guard_probability, 4)}
                    td.align-center
                        p #{format.percent(notDisplayed.middle_probability, 4)}
                    td.align-center
                        p #{format.percent(notDisplayed.exit_probability, 4)}
        else
            tbody
                tr
                    td(colspan='7', class='empty no-a') No relays found :(